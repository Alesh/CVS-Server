FROM cvs/base-python

ARG JANUS
ENV JANUS ${JANUS}
ARG POSTGRES
ENV POSTGRES ${POSTGRES}
ARG SERVER_PORT
ENV SERVER_PORT ${SERVER_PORT}
ARG SDK_API_URI
ENV SDK_API_URI ${SDK_API_URI}
ARG SDK_SIGNAL_URI
ENV SDK_SIGNAL_URI ${SDK_SIGNAL_URI}
ARG DEBUG
ENV DEBUG ${DEBUG:+-d}

WORKDIR /usr/src
COPY  . .
RUN python setup.py install

CMD python -m cvs.server -p ${SERVER_PORT} -d ${POSTGRES} -j ${JANUS} -a ${SDK_API_URI} -s ${SDK_SIGNAL_URI} ${DEBUG}

EXPOSE ${SERVER_PORT}